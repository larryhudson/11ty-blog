<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/css/style.css"/>
    <meta property="og:site_name" content="Larry Hudson"/>
    <meta property="og:title" content="Larry Hudson"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://larryhudson.io/"/>
    <meta name="author" content="Larry Hudson">
    <meta name="description" content="Web developer and programmer from Melbourne, Australia"/>
    <meta name="twitter:description" content="Web developer and programmer from Melbourne, Australia"/>
    <meta property="og:description" content="Web developer and programmer from Melbourne, Australia"/>
    <meta name="twitter:site" content="@larryhudsondev"/>
    <meta name="twitter:creator" content="@larryhudsondev"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" type="image/png"/>
    <link rel="icon" href="/icon.png" sizes="300x300" type="image/png"/>
    <link rel="icon" href="/favicon-96x96.png" sizes="96x96" type="image/png"/>
    <link rel="icon" href="/favicon-32x32.png" sizes="32x32" type="image/png"/>
    <link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png"/>
    <link rel="me" href="https://larryhudson.io/"/>
    <link rel="me" href="https://twitter.com/larryhudsondev"/>
    <link rel="me" href="https://www.linkedin.com/in/larry-hudson-4444a3117/"/>
    <link rel="me" href="https://github.com/larryhudson/"/>
    <link rel="me" href="https://www.last.fm/user/harryludson"/>
    <link rel="me" href="https://open.spotify.com/user/12173967323"/>
    <link rel="webmention" href="https://webmention.io/larryhudson.io/webmention"/>
    <link rel="pingback" href="https://webmention.io/larryhudson.io/xmlrpc"/>
    <link rel="alternate" type="application/rss+xml" title="Projects RSS feed" href="/feed.xml"/>
    <script type="module" src="/is-land.js"></script>
  </head>
  <body class="{% block bodyclass %}{% endblock %}">
    <header>
      {% block header %}
        <h1>Larry Hudson</h1>
      {% endblock %}
      {% block searchform %}
        <is-land on:interaction import="/alpine.js">
          <form method="get" action="/search/">
            <label for="search">Search</label>
            <input type="search" name="search" id="search">
            <button>Search</button>
          </form>
          <template data-island="replace">
            <script>
              document.addEventListener('alpine:init', () => {
                Alpine.data('alpineSearchData', () => ({
                  searchQuery: '',
                  searchResults: [],
                  async fetchResults(searchQuery) {
                    console.log(searchQuery)
                    if (searchQuery === "" || typeof searchQuery === 'undefined') 
                      this.searchResults = []
                    
                    const searchParams = new URLSearchParams({query: searchQuery}).toString()
                    const searchUrl = '/search-data.json?' + searchParams;
                    this.searchResults = await fetch(searchUrl).then(r => r.json())
                  },
                  init() {
                    document.getElementById("search").focus();
                    this.$watch('searchQuery', (searchQuery) => this.fetchResults(searchQuery))
                  }
                }))
              })
            </script>
            <form x-data="alpineSearchData" x-init="" method="get" action="/search/">
              <label for="search">Search</label>
              <input type="search" x-model.debounce="searchQuery" name="search" id="search">
              <button>Search</button>
              <ul x-if="searchResults">
                <template x-for="result in searchResults">
                  <li>
                    <a :href="result.url" x-text="result.title"></a>
                  </li>
                </template>
              </ul>
            </form>
          </template>
        </is-land>
      {% endblock %}
    </header>
    {% block body %}
      {{ content | safe }}
    {% endblock %}
  </body>
</html>